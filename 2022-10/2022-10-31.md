# 数据库技术

## E-R模型

E就是实体，R就是联系，E-R模型就是描述实体之间的联系

### 实体

就是一个对象，可以是抽象的，也可以是具体的。比如动物，小鸟，员工，房子等等都是实体

实体使用举行来表示

可以分为强实体和弱实体

弱实体是依赖于强实体存在的。比如一个E-R模型中有员工实体，经理实体，销售员实体等，员工实体就是强实体，经理和销售员本质上都是员工，是依赖于员工实体存在的，所以经理实体和销售员实体就是弱实体。

强实体和弱实体之间使用圈来连接

### 联系

实体间存在联系，使用菱形表示是什么联系。

联系可以分为一对一1:1,一对多1:N,多对多M:N，写在实体附近的线旁边

具体看联系是多少对多少时，要双向判断

### 属性

实体所具有的特性

分类

#### 简单属性和复合属性

- 简单属性指的是不可以再细分的属性，比如性别属性男和女，就没办法再细分了

- 复合属性指的是可以继续细分的属性，比如家庭住址，可以再分为国家，省市，乡镇等

#### 单值属性和多值属性

- 单值属性指的是属性只有一个值，比如员工实体的种族属性就全是人类，没有别的值

- 多值属性指的是属性有多个值，大部分的属性都是多个值，比如年龄属性，就有各种不同的年龄

#### null属性

指的是这个属性没有值

#### 派生属性

指该属性的值可以由别的属性计算的来，如年龄属性就可以由当前日期减去生日属性获得

### 域

一个属性所能取值得范文就叫做域

比如性别属性的取值范围一般情况下就是男和女，那么域就是男和女组成的集合

### 码

能够唯一标识一个实体的属性集合，可以是一个或多个属性

比如身份证号一个属性就可以唯一标识一个公民实体

班级号，座位号可以唯一标识一个学生实体

### 图示例子

![](http://cdn.frankjoey.com//img2/202210311142700.png)

## 关系模型

关系模型就是一个表格，由行列组成

每个列代表一个属性，为属性列

每一个行称为一个元祖或一条记录，实际上就是拥有这些属性的一个实体

### E-R模型转换为关系模型

实体都应该用关系模型表示

#### 一对一的联系

可以将联系直接用关系模型表示，也可以将其中一个实体的逐渐加在另一个实体的关系模型中

#### 一对多的联系

可以将联系直接用关系模型表示，也可以将"一"的实体的逐渐加在"多"的实体的关系模型中

#### 多对多的联系

必须将联系用关系模型表示

## 关系代数

设两个关系模型分别为S1和S2

### 并

$$ S1 \bigcup S2 $$

将S1和S2的所有记录都放到一个新的关系模型中，去掉完全相同的记录。也就是完全相同的记录只出现一次

没有顺序

$S1 \bigcup S2$ 和 $S2 \bigcup S1$是相同的

### 交

$$S1 \bigcap S2$$

将S1和S2中同时含有的完全相同的记录放到一个新的关系模型中。也就是S1和S2共有的记录

没有顺序

$S1 \bigcap S2$ 和 $S2 \bigcap \S1$是相同的

### 差

$$S1 - S2$$

以S1为基础，去掉S2中也含有的记录，形成一个新的关系模型

有顺序

$S1 - S2$和$S2 - S1$不一样
前者是以S1为基础，后者是以S2为基础

### 笛卡尔积

$S1 \times S2$

列的确定

由S1的所有列与S2的所有列组合而成，即使重复，也不会去重，所以列数为$S1的列数 + S2的列数$

行的确定

由S1的每一条记录与S2的每一条记录组合而成，即S1的一条记录与S2的每一条记录组合成的记录为S2的记录数，S1每一条记录都这样组合，所以形成的记录数为$S1的记录数 * S2的记录数$

#### 投影

符号为$\prod$

选出关系模型的某几列

可以用列名表示，也可以直接使用数字表示列，从1开始

假设S1为

|SNO|SNAME|SSCORE|
|---|---|---|
|202201|Marry|90|
|202202|Jack|86|
|202203|Bob|66|

前两列投影为
$\prod _{SNO,SNAME} (S1)$

也可以使用数字表示列

$\prod _{1,2} (S1)$ 因为列是从1开始数的，不是从0开始

投影出来的结果应该是
|SNO|SNAME|
|---|---|
|202201|Marry|
|202202|Jack|
|202203|Bob|

#### 选择

符号$\sigma$

选出关系模型中若干行记录

用符号表示的时候，选择某一个列等于某个值得记录

$\sigma _{1 = '202201'} (S1)$

表示选择第一列为202201的记录

结果为

|SNO|SNAME|SSCORE|
|--|--|--|
|202201|Marry|90|

### 自然连接

$$S1 ⨝ S2$$

列的确定

S1的所有列加上S2的所有列去重，即相同的列只显示一次

行的确定

只选择相同列的值也相同的记录

#### 例子

|a|b|c|
|-|-|-|
|1|2|3|
|3|2|1|
|2|2|2|
|1|3|2|

|a|c|d|
|-|-|-|
|1|2|3|
|3|1|2|
|1|3|2|

$S1 ⨝ S2$的结果
|a|b|c|d|
|-|-|-|-|
|1|2|3|2|
|3|2|1|2|
|1|3|2|3|

#### 笛卡尔积转自然连接

列的转换

笛卡尔积的列包含重复的部分，去掉重复的部分
笛卡尔积的列
a b c a c d
转换操作为
$\prod _{1,2,3,6} $

行的转换

只要相同列的值也相同的记录
所以就是a列和c列都分别相同的记录
转换操作为
$\sigma _{1=4,3=5}$

所以

$S1 ⨝ S2 = \prod _{1,2,3,6} ( \sigma _{1=4,3=5} (S1 \times S2))$

## 函数依赖

属性之间的关系
如果A属性能唯一标识B属性
则称A可以确定B，也可以说，B依赖于A

### 部分依赖关系

如果A可以确定C，(A,B)可以确定C，(A,B)中的一部分（即A）就可以确定C，这样就成C部分依赖于(A,B)

### 传递依赖关系

如果A可以确定B,B可以确定C，并且A与B不等价，则A可以确定C，C与A就是传递依赖关系

A与B必须不等价，否则A直接就可以确定C，不用传递依赖

### 超键

能够唯一标识一条记录的属性的集合，只要包含着候选键的属性的属性集合都可以被称为超键

### 候选键

去掉超键中冗余的属性，即唯一标识记录的最小属性集合，再减少属性就不能唯一标识了。
可以有多个候选键

### 主键

在候选键中取一个作为主键

### 外键

其他表的主键

### 主属性

所有候选键的所有属性的集合，称为主属性

## 范式

设计关系表的一些规范

### 第一范式

不存在复合属性，即属性不可再分。
这是形成一个关系表的最基础条件。

### 第二范式

### 第三范式