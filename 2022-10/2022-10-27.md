# 操作系统

## 进程管理

三态图，进程，死锁，PV操作等

## 存储管理

分页存储管理，
分段存储管理

## 设备管理

I/O,SPOOLING技术

## 文件管理

索引文件管理，文件目录

# 进程管理

## 进程组成

### 进程控制块

唯一标识某个进程

### 程序

表示当前程序要做那些事

### 数据

存储进程运行过程中所需要的数据

## 三态图

进程有三种状态
- 运行，什么都不缺，正在运行
- 就绪，只缺cpu，其他什么都不缺
- 阻塞，也叫等待状态。除了却cpu，还缺其他东西，一般是缺数据

![](http://cdn.frankjoey.com//img2/202210271619970.png)

运行和就绪之间的转换就是cpu执行进程的转换，cpu不会一直执行某一个进程，而是不断切换执行不同的进程，使各进程看上去像是在并行。
时间片到，就是cpu不再执行该进程，轮到执行其他进程了，被调度就是cpu开始执行本进程了

# 进程的同步和互斥

## 同步

多个任务可以并发执行，只不过速度有快慢，在一定情况下，速度快的还会等待速度慢的任务

## 互斥

对某一资源同一时间只能有一个任务访问，访问的时候加锁，访问完后解锁，其他任务才可以访问

## 临界资源

需要进程以互斥方式访问的资源

## 临界区

进程中用来访问临界资源的程序代码，本质是一段程勋

## 互斥信号量

访问临界资源时用到，初值为1，当有进程访问时，就变为了0，不能再被访问

## 同步信号量

访问共享资源时用到，初值为共享资源的数量。比如有4台电脑，有一个进程访问，就减少一台，有4个进程访问，同步信号量就变为0了

## PV操作

PV操作就是申请资源和释放资源操作，假设S为当前信号量（既可以是互斥信号量，也可以是同步信号量）

### P操作

申请资源
S = S - 1
当S >= 0时，说明还有资源可以使用，进程继续执行
当S < 0时，说明没有资源了，需要等待其他进程释放资源，所以将当前进程加入阻塞队列（等待队列）

### V操作

释放资源
S = S + 1
当S <= 0时，说明资源还是不够，继续执行当前释放资源的进程
当S > 0时，说明该进程释放完资源后，有资源可以使用了，将当前等待队列中的一个进程加入就绪队列，然后继续执行本进程

# 死锁

死锁是指多个进程都在等待不可能完成的事情

## 死锁的四大条件

- 资源互斥
  如果是同步资源的话，就没必要等待了

- 每个进程都占用资源并且等待其他资源
  其中一个进程占用的资源是另一个进程等待的资源，该进程由等待其他资源导致不能完成，从而使等待它占用资源的进程也无法完成

- 系统不能强制剥夺进程的资源
  如果系统能够剥夺资源，就不存在死锁了，直接剥夺资源就解开死锁了

- 进程资源是一个环路
  也就是一个进程占用的资源是另一个进程等待的资源

## 解除死锁

- 死锁预防
  破坏死锁的四大条件，使其不能造成死锁

- 死锁避免
  银行家算法，先设计好一个不会造成死锁的资源分配方法，否则不分配资源。就像是银行借贷的时候，判断用户能够还清贷款才会借贷

- 死锁解除
  系统强制剥夺进程资源

- 死锁检测
  每个一定时间检测是否发生死锁

## 死锁资源量计算

假设有n个进程，每个进程所需资源量为R

能够造成死锁的最大资源量为
n(R-1)
即每个进程都缺少一个资源

不造成死锁的最小资源量为
n(R-1)+1
在上面的基础上再多出一个资源，就能让一个进程结束等待，该进程运行完成后又会释放资源，从而其他进程也不会缺少资源了
